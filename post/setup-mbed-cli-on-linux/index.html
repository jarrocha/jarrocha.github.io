<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:site_name" content="Innercoder.dev">
    <meta property="og:type" content="article">

    
    <meta property="og:image" content="https://jarrocha.github.io/img/backgrounds/tech18.jpg">
    <meta property="twitter:image" content="https://jarrocha.github.io/img/backgrounds/tech18.jpg" />
    

    
    <meta name="title" content="Setting up ARM MbedOS cli and Zephyr OS on Linux" />
    <meta property="og:title" content="Setting up ARM MbedOS cli and Zephyr OS on Linux" />
    <meta property="twitter:title" content="Setting up ARM MbedOS cli and Zephyr OS on Linux" />
    

    
    <meta name="description" content="Quick steps to get up and running fast. Includes scripts">
    <meta property="og:description" content="Quick steps to get up and running fast. Includes scripts" />
    <meta property="twitter:description" content="Quick steps to get up and running fast. Includes scripts" />
    

    
    <meta property="twitter:card" content="summary" />
    
    

    <meta name="keyword"  content="Linux, C, C&#43;&#43;, macOS, mbedOS">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>Setting up ARM MbedOS cli and Zephyr OS on Linux-Innercoder.dev</title>

    <link rel="canonical" href="/post/setup-mbed-cli-on-linux/">

    <link rel="stylesheet" href="/css/iDisqus.min.css"/>
	
    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    
    <link rel="stylesheet" href="/css/zanshang.css">
    
    
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    
    

    
    
    <script src="/js/jquery.min.js"></script>
    
    
    <script src="/js/bootstrap.min.js"></script>
    
    
    <script src="/js/hux-blog.min.js"></script>

    
    

</head>



<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Innercoder.dev</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                        
                    
                    
		    
                        <li><a href="/top/upcoming/">UPCOMING</a></li>
                    
                        <li><a href="/top/courses/">COURSES</a></li>
                    
                        <li><a href="/top/about/">ABOUT</a></li>
                    

                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header {
        background-image: url('/img/backgrounds/tech18.jpg')
    }
</style>
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/arm" title="ARM">
                            ARM
                        </a>
                        
                        <a class="tag" href="/tags/linux" title="Linux">
                            Linux
                        </a>
                        
                        <a class="tag" href="/tags/mbedos" title="mbedOS">
                            mbedOS
                        </a>
                        
                        <a class="tag" href="/tags/zephyr" title="Zephyr">
                            Zephyr
                        </a>
                        
                        <a class="tag" href="/tags/rtos" title="RTOS">
                            RTOS
                        </a>
                        
                    </div>
                    <h1>Setting up ARM MbedOS cli and Zephyr OS on Linux</h1>
                    <h2 class="subheading"></h2>
                    <span class="meta">
                        Posted by 
                        
                                 &#34;Jaime Arrocha&#34;
                         
                        on 
                        Monday, May 4, 2020
                        
                        
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-11 col-lg-offset-1
                col-md-10 col-md-offset-1
                post-container">

                
                <header>
                    <h2>TOC</h2>
                </header>
                <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#__introduction__"><strong>Introduction</strong></a></li>
        <li><a href="#__mbed-os-steps__"><strong>Mbed OS Steps</strong></a></li>
        <li><a href="#__zephyr-steps__"><strong>Zephyr Steps</strong></a></li>
        <li><a href="#__final-notes__"><strong>Final Notes</strong></a></li>
      </ul>
    </li>
  </ul>
</nav>
                
                <h2 id="__introduction__"><strong>Introduction</strong></h2>
<hr>
<p>This tutorial comes from the fact that there are several steps where errors can come up.
We first install MbedOS cli.</p>
<p>Zephyr is a little easier to setup compared to Mbed OS to setup. This was done on <strong>Debian 9</strong> with a <strong>FRDM-K64F</strong>.</p>
<h2 id="__mbed-os-steps__"><strong>Mbed OS Steps</strong></h2>
<hr>
<p><strong>1.</strong> Download the latest toolchain. It can be untar and installed where its more convinient:
<a href="https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain/gnu-rm/downloads">https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain/gnu-rm/downloads</a></p>
<p><strong>2.</strong>  Install mbed-cli with python. This steps are well made from the website. Make your to be using Python3.
<a href="https://os.mbed.com/docs/mbed-os/v6.3/build-tools/install-and-set-up.html">https://os.mbed.com/docs/mbed-os/v6.3/build-tools/install-and-set-up.html</a></p>
<p><strong>3.</strong> Configure GCC_ARM_PATH and ARM_PATH</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ mbed config -G ARM_PATH <span style="color:#e6db74">&#34;&lt;path to ARM bin\&gt;&#34;</span>
$ mbed config -G GCC_ARM_PATH <span style="color:#e6db74">&#34;&lt;path to ARM bin\&gt;&#34;</span>
</code></pre></div><p>Test output:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>mbed<span style="color:#f92672">]</span> Global config:
ARM_PATH<span style="color:#f92672">=</span>/home/jaime/programs/gcc-arm-none-eabi-9-2020-q2-update/bin/
GCC_ARM_PATH<span style="color:#f92672">=</span>/home/jaime/programs/gcc-arm-none-eabi-9-2020-q2-update/bin/
</code></pre></div><p><strong>4.</strong> Go to the directory to create the MbedOS projects:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cd /absolute/path/to/project/dir/
</code></pre></div><p><strong>5.</strong> Add mbed-os libraries:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ mbed add mbed-os
</code></pre></div><p>You will end up with the mbed-os directory at this location</p>
<p><strong>6.</strong> Configure your mbed-os sources:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ mbed config -G MBED_OS_DIR /absolute/path/to/project/dir/mbed-os
</code></pre></div><p>You can test this was done with the command: $ mbed config &ndash;list</p>
<p><strong>7.</strong> Create your new project</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ mbed new proj1
</code></pre></div><p><strong>8.</strong> Create a test <code>main.c</code> at this location <code>/absolute/path/to/project/dir/proj1</code>
and use the code below from the blink test project.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#75715e">/* mbed Microcontroller Library
</span><span style="color:#75715e"> * Copyright (c) 2019 ARM Limited
</span><span style="color:#75715e"> * SPDX-License-Identifier: Apache-2.0
</span><span style="color:#75715e"> */</span>

<span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;mbed.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>

<span style="color:#75715e">// Blinking rate in milliseconds
</span><span style="color:#75715e"></span><span style="color:#75715e">#define BLINKING_RATE     100ms
</span><span style="color:#75715e"></span>

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
{
    <span style="color:#75715e">// Initialise the digital pin LED1 as an output
</span><span style="color:#75715e"></span>    DigitalOut led(LED1);

    <span style="color:#66d9ef">while</span> (true) {
        led <span style="color:#f92672">=</span> <span style="color:#f92672">!</span>led;
        ThisThread<span style="color:#f92672">::</span>sleep_for(BLINKING_RATE);
    }
}
</code></pre></div><p><strong>9.</strong> To compile your project, make sure you are at the root location for your projects,
which is <code>/absolute/path/to/project/dir/</code>
From this location you will run the compilation commands.</p>
<p>I created a Makefile to make it easier to run them. Copy, paste and run this Makefile at this root location.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Makefile" data-lang="Makefile"><span style="color:#a6e22e">deps</span><span style="color:#f92672">:</span>
	mbed toolchain GCC_ARM
	mbed target K64F
<span style="color:#a6e22e">proj1</span><span style="color:#f92672">:</span> deps
	mbed compile -v -t GCC_ARM -N $@ --source $@ --source mbed-os --build ./BUILD/$@ --flash
</code></pre></div><p>Run with:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ make proj1
</code></pre></div><h2 id="__zephyr-steps__"><strong>Zephyr Steps</strong></h2>
<hr>
<p><strong>1.</strong> Install the necessary requirements</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Bash" data-lang="Bash">sudo apt-get install --no-install-recommends git cmake ninja-build gperf <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  ccache dfu-util device-tree-compiler wget <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  python3-pip python3-setuptools python3-wheel xz-utils file make gcc
</code></pre></div><p><strong>2.</strong>  Download and Install SDK</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Bash" data-lang="Bash">wget https://github.com/zephyrproject-rtos/sdk-ng/releases/download/v0.10.0/zephyr-sdk-0.10.0-setup.run
cd &lt;sdk download directory&gt;
sh zephyr-sdk-0.10.0-setup.run
export ZEPHYR_TOOLCHAIN_VARIANT<span style="color:#f92672">=</span>zephyr
export ZEPHYR_GCC_VARIANT<span style="color:#f92672">=</span>zephyr
export ZEPHYR_SDK_INSTALL_DIR<span style="color:#f92672">=</span>&lt;sdk installation directory&gt;
</code></pre></div><p><strong>3.</strong> Get the kernel</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Bash" data-lang="Bash">git clone git@github.com:zephyrproject-rtos/zephyr.git
</code></pre></div><p><strong>4.</strong> Do Hello World</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Bash" data-lang="Bash">https://docs.zephyrproject.org/latest/boards/arm/frdm_k64f/doc/index.html
git checkout tags/v1.8.0
source zephyr-env.sh
cd $ZEPHYR_BASE/samples/hello_world
make BOARD<span style="color:#f92672">=</span>frdm-k64f
</code></pre></div><p><strong>Common errors</strong></p>
<ul>
<li>Install Pyyaml and elftools using the following command:</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Bash" data-lang="Bash">sudo pip3 install -r scripts/requirements.txt 
</code></pre></div><h2 id="__final-notes__"><strong>Final Notes</strong></h2>
<hr>
<p>You can remove the <code>-v</code> option to remove logs and speed it up. And of course the Makefile can be improved. This was done to get it done quick.
When you create another project, just duplicate the last two lines replacing only the project name.</p>
<p>Hope this quick tutorial helps people to get up to speed fast on this environment. The actual website misses explaining some things and lacks in others.</p>


                

                <hr>
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/post/2018-11-18-char-driver/" data-toggle="tooltip" data-placement="top" title="Linux Kernel Modules: Character Devices">&larr;
                            Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/post/euler1/" data-toggle="tooltip" data-placement="top" title="Dynamic System Integration and Plotting with C&#43;&#43;">Next
                            Post &rarr;</a>
                    </li>
                    
                </ul>

                
<div id="disqus-comment"></div>



            </div>
            
            <div class="
                col-lg-11 col-lg-offset-1
                col-md-10 col-md-offset-1
                sidebar-container">

                
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                        
                        
                        
                        
                        
                        <a href="/tags/bash" title="bash">
                            bash
                        </a>
                        
                        
                        
                        <a href="/tags/c" title="c">
                            c
                        </a>
                        
                        
                        
                        <a href="/tags/development" title="development">
                            development
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/dynamic-systems" title="dynamic-systems">
                            dynamic-systems
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/kvm" title="kvm">
                            kvm
                        </a>
                        
                        
                        
                        <a href="/tags/linux" title="linux">
                            linux
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/opencv" title="opencv">
                            opencv
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/python" title="python">
                            python
                        </a>
                        
                        
                        
                        <a href="/tags/qemu" title="qemu">
                            qemu
                        </a>
                        
                        
                        
                        <a href="/tags/quadrotor" title="quadrotor">
                            quadrotor
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/tcp/ip" title="tcp/ip">
                            tcp/ip
                        </a>
                        
                        
                        
                        <a href="/tags/x86-assembly" title="x86-assembly">
                            x86-assembly
                        </a>
                        
                        
                        
                        
                    </div>
                </section>
                

                
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                   
                    
                    <li>
                        <a href="mailto:jarrocha@linux.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    

                    

		    
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/jarrocha">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    <li>
                        <a target="_blank" href="https://gitlab.com/jarrocha27">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-gitlab fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
            
                    
                    
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/in/jaime-arrocha-337b0488/">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    <li>
                        <a target="_blank" href="https://stackoverflow.com/users/3848072/jarr">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-stack-overflow fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
            
                    
                    
                    
            
            
            
                </ul>
		<p class="copyright text-muted">
                    Copyright &copy; Innercoder.dev 2022
                    <br>
                    <a href="https://themes.gohugo.io/hugo-theme-cleanwhite">CleanWhite Hugo Theme</a> by <a href="https://zhaohuabing.com">Huabing</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    async("https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>






</body>
</html>
