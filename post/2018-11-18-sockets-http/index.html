<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:site_name" content="Innercoder.dev">
    <meta property="og:type" content="article">

    
    <meta property="og:image" content="https://jarrocha.github.io/img/iot.jpg">
    <meta property="twitter:image" content="https://jarrocha.github.io/img/iot.jpg" />
    

    
    <meta name="title" content="Capturing Websites With Sockets and HTTP" />
    <meta property="og:title" content="Capturing Websites With Sockets and HTTP" />
    <meta property="twitter:title" content="Capturing Websites With Sockets and HTTP" />
    

    
    <meta name="description" content="Use sockets to create your own version of wget.">
    <meta property="og:description" content="Use sockets to create your own version of wget." />
    <meta property="twitter:description" content="Use sockets to create your own version of wget." />
    

    
    <meta property="twitter:card" content="summary" />
    
    

    <meta name="keyword"  content="Linux, C, C&#43;&#43;, macOS, mbedOS">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>Capturing Websites With Sockets and HTTP-Innercoder.dev</title>

    <link rel="canonical" href="/post/2018-11-18-sockets-http/">

    <link rel="stylesheet" href="/css/iDisqus.min.css"/>
	
    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    
    <link rel="stylesheet" href="/css/zanshang.css">
    
    
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    
    

    
    
    <script src="/js/jquery.min.js"></script>
    
    
    <script src="/js/bootstrap.min.js"></script>
    
    
    <script src="/js/hux-blog.min.js"></script>

    
    

</head>



<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Innercoder.dev</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                        
                    
                    
		    
                        <li><a href="/top/upcoming/">UPCOMING</a></li>
                    
                        <li><a href="/top/courses/">COURSES</a></li>
                    
                        <li><a href="/top/about/">ABOUT</a></li>
                    

                    
		    <li>
                        <a href="/search">SEARCH <img src="/img/search.png" height="15" style="cursor: pointer;" alt="Search"></a>
		    </li>
                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header {
        background-image: url('/img/post-bg-unix-linux.jpg')
    }
</style>
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/development" title="Development">
                            Development
                        </a>
                        
                        <a class="tag" href="/tags/linux" title="Linux">
                            Linux
                        </a>
                        
                    </div>
                    <h1>Capturing Websites With Sockets and HTTP</h1>
                    <h2 class="subheading"></h2>
                    <span class="meta">
                        Posted by 
                        
                            Jaime Arrocha
                         
                        on 
                        Friday, September 2, 2016
                        
                        
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-11 col-lg-offset-1
                col-md-10 col-md-offset-1
                post-container">

                
                <header>
                    <h2>TOC</h2>
                </header>
                <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#intro">Intro</a></li>
</ul></li>
</ul>
</nav>
                
                <h2 id="intro">Intro</h2>

<hr />

<p>This post shows a program that captures web pages&rsquo;s index.html with sockets.
To do this, it creates a TCP client socket, connects to a web server and takes
all the data to stdout. The input supports IPv4, IPv6, and hostname resolution.</p>

<p>As simple as it may sound, there are always little things to take into account,
which gets you to start investigating about special options and tweaks you can
make to your function calls.</p>

<p>Complete code at its <a href="https://github.com/jarrocha/psockets/tree/master/get_http">github repository</a>.</p>

<h4>main.c</h4>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 0</span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>argv[])
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 1</span>{
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 2</span>  u_int trx_fd;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 3</span>  u_int resv4;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 4</span>  u_int resv6;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 5</span>  u_int status <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 6</span>  <span style="color:#66d9ef">char</span> buffer[MAX];
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 7</span>  <span style="color:#66d9ef">struct</span> addrinfo hints;      <span style="color:#75715e">/* DNS resolution processing */</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 8</span>  <span style="color:#66d9ef">struct</span> addrinfo <span style="color:#f92672">*</span>rs;     <span style="color:#75715e">/* DNS results */</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 9</span>  <span style="color:#66d9ef">struct</span> sockaddr_in svr_addr4;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">10</span>  <span style="color:#66d9ef">struct</span> sockaddr_in <span style="color:#f92672">*</span>pr;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">11</span>  <span style="color:#66d9ef">struct</span> sockaddr_in6 svr_addr6;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">12</span>  <span style="color:#66d9ef">struct</span> timeval tt_wait;     <span style="color:#75715e">/* used for recv() timeout */</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">13</span>  tt_wait.tv_sec <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>;      <span style="color:#75715e">/* 3 secs timeout */</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">14</span>  tt_wait.tv_usec<span style="color:#f92672">=</span> <span style="color:#ae81ff">500000</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">15</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">16</span>  <span style="color:#66d9ef">if</span>(argc <span style="color:#f92672">!=</span> <span style="color:#ae81ff">2</span>) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">17</span>      usage(argv[<span style="color:#ae81ff">0</span>]);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">18</span>      exit(<span style="color:#ae81ff">0</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">19</span>  }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">20</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">21</span>  <span style="color:#75715e">/* initializing addrinfo structure list */</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">22</span>        hints.ai_flags <span style="color:#f92672">=</span> AF_INET;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">23</span>        hints.ai_family <span style="color:#f92672">=</span> AF_UNSPEC;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">24</span>        hints.ai_socktype <span style="color:#f92672">=</span> SOCK_STREAM;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">25</span>        hints.ai_protocol <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">26</span>        hints.ai_addrlen <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">27</span>        hints.ai_canonname <span style="color:#f92672">=</span> NULL;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">28</span>        hints.ai_addr <span style="color:#f92672">=</span> NULL;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">29</span>        hints.ai_next <span style="color:#f92672">=</span> NULL;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">30</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">31</span>  <span style="color:#75715e">/* get IP info */</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">32</span>  resv4 <span style="color:#f92672">=</span> inet_pton(AF_INET, argv[<span style="color:#ae81ff">1</span>], <span style="color:#f92672">&amp;</span>svr_addr4.sin_addr);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">33</span>  resv6 <span style="color:#f92672">=</span> inet_pton(AF_INET6, argv[<span style="color:#ae81ff">1</span>], <span style="color:#f92672">&amp;</span>svr_addr6.sin6_addr);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">34</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">35</span>  <span style="color:#75715e">/* entering http server presets in structure */</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">36</span>  svr_addr4.sin_port <span style="color:#f92672">=</span>  htons((in_port_t) <span style="color:#ae81ff">80</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">37</span>  svr_addr4.sin_family <span style="color:#f92672">=</span> AF_INET;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">38</span>  svr_addr6.sin6_port <span style="color:#f92672">=</span>  htons((in_port_t) <span style="color:#ae81ff">80</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">39</span>  svr_addr6.sin6_family <span style="color:#f92672">=</span> AF_INET6;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">40</span>  sprintf(buffer, <span style="color:#e6db74">&#34;GET / HTTP/1.1</span><span style="color:#ae81ff">\r\n\r\n</span><span style="color:#e6db74">&#34;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">41</span>      
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">42</span>  <span style="color:#75715e">/* checking for either IPv4 or IPv6 entered input */</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">43</span>  <span style="color:#66d9ef">while</span> (status <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">44</span>      <span style="color:#66d9ef">if</span>(resv4 <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">45</span>          <span style="color:#66d9ef">if</span>((trx_fd <span style="color:#f92672">=</span> socket(AF_INET, SOCK_STREAM, <span style="color:#ae81ff">0</span>)) <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">46</span>              err_msg(<span style="color:#e6db74">&#34;Error creating socket&#34;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">47</span>          <span style="color:#66d9ef">if</span> ((setsockopt(trx_fd, SOL_SOCKET, SO_RCVTIMEO,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">48</span>                  (<span style="color:#66d9ef">struct</span> timeval <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>tt_wait,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">49</span>                  <span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">struct</span> timeval))) <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">50</span>              err_msg(<span style="color:#e6db74">&#34;setsockopt()&#34;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">51</span>          <span style="color:#75715e">/* get out of the loop */</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">52</span>          status <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">53</span>          get_http_ipv4(<span style="color:#f92672">&amp;</span>trx_fd, <span style="color:#f92672">&amp;</span>svr_addr4, buffer);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">54</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">55</span>      } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(resv6 <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">56</span>          <span style="color:#66d9ef">if</span>((trx_fd <span style="color:#f92672">=</span> socket(AF_INET6, SOCK_STREAM, <span style="color:#ae81ff">0</span>)) <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">57</span>              err_msg(<span style="color:#e6db74">&#34;Error creating socket&#34;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">58</span>          <span style="color:#66d9ef">if</span> ((setsockopt(trx_fd, SOL_SOCKET, SO_RCVTIMEO,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">59</span>                  (<span style="color:#66d9ef">struct</span> timeval <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>tt_wait,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">60</span>                  <span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">struct</span> timeval))) <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">61</span>              err_msg(<span style="color:#e6db74">&#34;setsockopt()&#34;</span>);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">62</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">63</span>          <span style="color:#75715e">/* get out of the loop */</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">64</span>          status <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">65</span>          get_http_ipv6(<span style="color:#f92672">&amp;</span>trx_fd, <span style="color:#f92672">&amp;</span>svr_addr6, buffer);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">66</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">67</span>      } <span style="color:#66d9ef">else</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">68</span>          <span style="color:#66d9ef">if</span> ((getaddrinfo(argv[<span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">0</span>, <span style="color:#f92672">&amp;</span>hints, <span style="color:#f92672">&amp;</span>rs)) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">69</span>              err_msg(gai_strerror(status));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">70</span>          resv4 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">71</span>          <span style="color:#66d9ef">for</span>(; rs <span style="color:#f92672">!=</span> NULL; rs <span style="color:#f92672">=</span> rs<span style="color:#f92672">-&gt;</span>ai_next){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">72</span>              <span style="color:#66d9ef">if</span>(rs<span style="color:#f92672">-&gt;</span>ai_family <span style="color:#f92672">==</span> AF_INET) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">73</span>                  <span style="color:#75715e">/* typecasting result and assigning */</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">74</span>                  pr <span style="color:#f92672">=</span>  (<span style="color:#66d9ef">struct</span> sockaddr_in <span style="color:#f92672">*</span>)rs<span style="color:#f92672">-&gt;</span>ai_addr;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">75</span>                  svr_addr4.sin_addr <span style="color:#f92672">=</span> pr<span style="color:#f92672">-&gt;</span>sin_addr;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">76</span>                  <span style="color:#66d9ef">break</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">77</span>              }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">78</span>          }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">79</span>          <span style="color:#75715e">/* freeing allocated struct rs memory */</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">80</span>          freeaddrinfo(rs);       
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">81</span>      }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">82</span>  }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">83</span>  close(trx_fd);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">84</span>  exit(EXIT_SUCCESS);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">85</span>}</code></pre></div>

<p>The main function program. Takes care of the socket structure initialization,
hostname resolution structure allocations, and center point of the program&rsquo;s
execution. There are two execution paths for the socket creation which is
determined by the user&rsquo;s input of either IPv4 or IPv6.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 0</span><span style="color:#66d9ef">if</span> ((getaddrinfo(argv[<span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">0</span>, <span style="color:#f92672">&amp;</span>hints, <span style="color:#f92672">&amp;</span>rs)) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 1</span>              err_msg(gai_strerror(status));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 2</span>          resv4 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 3</span>          <span style="color:#66d9ef">for</span>(; rs <span style="color:#f92672">!=</span> NULL; rs <span style="color:#f92672">=</span> rs<span style="color:#f92672">-&gt;</span>ai_next){
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 4</span>              <span style="color:#66d9ef">if</span>(rs<span style="color:#f92672">-&gt;</span>ai_family <span style="color:#f92672">==</span> AF_INET) {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 5</span>                  <span style="color:#75715e">/* typecasting result and assigning */</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 6</span>                  pr <span style="color:#f92672">=</span>  (<span style="color:#66d9ef">struct</span> sockaddr_in <span style="color:#f92672">*</span>)rs<span style="color:#f92672">-&gt;</span>ai_addr;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 7</span>                  svr_addr4.sin_addr <span style="color:#f92672">=</span> pr<span style="color:#f92672">-&gt;</span>sin_addr;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 8</span>                  <span style="color:#66d9ef">break</span>;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79"> 9</span>              }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7c7c79">10</span>}</code></pre></div>

<p>These are the functions that handle the obtention of html data after host IP is
processed. You can see there&rsquo;s no much difference to handling IPv4 and IPv6.</p>

<pre><code class="language-Bash">[jaime@LenoLX get_http]$ ./get_http google.com
Connect success
HTTP/1.1 200 OK
Date: Fri, 08 Jul 2016 02:41:29 GMT
Expires: -1
Cache-Control: private, max-age=0
Content-Type: text/html; charset=ISO-8859-1
P3P: CP=&quot;This is not a P3P policy! See https://www.google.com/support/accounts/answer/151657?hl=en for more info.&quot;
Server: gws
X-XSS-Protection: 1; mode=block
X-Frame-Options: SAMEORIGIN
Set-Cookie: NID=81=c8P0vCMGE0EVBx1CcgD_L0zbXecKEkHGvp3-WqJbLPsYUnMlYqFG-pvG_51WUYGdO5r1uNHvZYBnDGaWia04G6bl_htmxu_Jn5_n2xqeUOJrr8TwIxRuSUw-eW76yrKomwKpCGFPhmQx6Ts; expires=Sat, 07-Jan-2017 02:41:29 GMT; path=/; domain=.google.com; HttpOnly
Accept-Ranges: none
Vary: Accept-Encoding
Transfer-Encoding: chunked

&lt;!doctype html&gt;&lt;html itemscope=&quot;&quot; itemtype=&quot;http://schema.org/WebPage&quot; lang=&quot;en&quot;&gt;&lt;head&gt;&lt;meta content=&quot;Search the world's information, including webpages, images, videos and more. Google has many special features to help you find exactly what you're looking for.&quot; name=&quot;description&quot;&gt;&lt;meta content=&quot;noodp&quot; name=&quot;robots&quot;&gt;&lt;meta content=&quot;text/html; charset=UTF-8&quot;

.....


from your \u003Ca href=\&quot;/history\&quot;\u003EWeb History\u003C/a\u003E&quot;,&quot;psrl&quot;:&quot;Remove&quot;,&quot;sbit&quot;:&quot;Search by image&quot;,&quot;srch&quot;:&quot;Google Search&quot;},&quot;nds&quot;:true,&quot;ovr&quot;:{},&quot;pq&quot;:&quot;&quot;,&quot;refpd&quot;:true,&quot;rfs&quot;:[],&quot;scd&quot;:10,&quot;sce&quot;:5,&quot;stok&quot;:&quot;u8v0kV7gXuv6UGgEJLZk39LT_Ww&quot;},&quot;d&quot;:{}};google.y.first.push(function(){if(google.med){google.med('init');google.initHistory();google.med('history');}});if(google.j&amp;&amp;google.j.en&amp;&amp;google.j.xi){window.setTimeout(google.j.xi,0);}
&lt;/script&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
0
</code></pre>

<p>The program works as expected, above is an example of its functioning.</p>

<p>I still have to think of other features for this program. One of them could be
to extent the input from just getting
<strong>index.html</strong>. Or download a complete website to a specified directory. Apart
from that I will also be working to test for correct input.</p>

<p>More to come.</p>

                

                <hr>
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/post/2018-11-18-pthreaded-server/" data-toggle="tooltip" data-placement="top" title="Implementing a Prethreaded Web Server">&larr;
                            Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/post/2018-11-18-network-sniffer/" data-toggle="tooltip" data-placement="top" title="Coding Your Own Network Sniffer">Next
                            Post &rarr;</a>
                    </li>
                    
                </ul>

                
<div id="disqus-comment"></div>



            </div>
            
            <div class="
                col-lg-11 col-lg-offset-1
                col-md-10 col-md-offset-1
                sidebar-container">

                
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                        
                        
                        
                        <a href="/tags/arm" title="ARM">
                            ARM
                        </a>
                        
                        
                        
                        <a href="/tags/bash" title="Bash">
                            Bash
                        </a>
                        
                        
                        
                        <a href="/tags/c" title="C">
                            C
                        </a>
                        
                        
                        
                        <a href="/tags/development" title="Development">
                            Development
                        </a>
                        
                        
                        
                        <a href="/tags/kvm" title="KVM">
                            KVM
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/linux" title="Linux">
                            Linux
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/qemu" title="QEMU">
                            QEMU
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/tcp/ip" title="TCP/IP">
                            TCP/IP
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/x86-assembly" title="x86 Assembly">
                            x86 Assembly
                        </a>
                        
                        
                    </div>
                </section>
                

                
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                   
                    
                    <li>
                        <a href="mailto:jarrocha@linux.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    

                    

		    
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/jarrocha">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    <li>
                        <a target="_blank" href="https://gitlab.com/jarrocha27">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-gitlab fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
            
                    
                    
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/in/jaime-arrocha-337b0488/">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    <li>
                        <a target="_blank" href="https://stackoverflow.com/users/3848072/jarr">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-stack-overflow fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
            
                    
                    
                    
            
            
            
                </ul>
		<p class="copyright text-muted">
                    Copyright &copy; Innercoder.dev 2022
                    <br>
                    <a href="https://themes.gohugo.io/hugo-theme-cleanwhite">CleanWhite Hugo Theme</a> by <a href="https://zhaohuabing.com">Huabing</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    async("https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>






</body>
</html>
